This code is far from ready. Please ignore.
===========================================
